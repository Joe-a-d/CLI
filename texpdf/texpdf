#!/bin/bash
#compile tex files , bib (if mod) and clean aux files


# init stat shell vars
eval $(stat -s $1.bib)
mTime=$st_mtime
echo $mTime
# compile bibliography
function bib(){
		echo "KSAJFKLASDASDJKL: \n aaslkdjlsaj djasldj \n"
		echo "RUNNING BIBER"
		echo "KSAJFKLASDASDJKL: \n aaslkdjlsaj djasldj \n"
		biber "$1"
		pdflatex "$1.tex"
		pdflatex "$1.tex"
		echo "FINISHED: \n aaslkdjlsaj djasldj \n"
	}

if [[ ! (-e ".tmp.sh") ]] ; then
	echo "preTime=$mTime" > ".tmp.sh"
	pdflatex "$1.tex"
	bib $1
else
	source .tmp.sh
	if [[ preTime -eq mTime ]] ; then
		pdflatex "$1.tex"
	else
		pdflatex "$1.tex"
		bib $1
	fi
fi

#clear aux files
latexmk -c
rm *\.xml
